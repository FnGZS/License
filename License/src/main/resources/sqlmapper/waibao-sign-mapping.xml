<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.waibao.dao.waibao.WaibaoSignDao">
<resultMap id="BaseResultMap" type="com.waibao.dao.waibao.dataobject.SignListDO" >
    <id column="id" property="id" jdbcType="BIGINT" />
    <result column="project_id" property="projectId" jdbcType="BIGINT" />
    <result column="user_id" property="userId" jdbcType="BIGINT" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="head_img" property="headImg" jdbcType="VARCHAR" />
</resultMap>
<select id="getSignList" resultMap="BaseResultMap" >
    select 
    ws.id, ws.project_id, ws.user_id, ws.is_choose,
    wl.user_name,wl.head_img
    from waibao_sign as ws
    LEFT JOIN waibao_login as wl ON wl.id=ws.user_id
    where ws.project_id = #{projectId,jdbcType=BIGINT}
 </select>
 <insert id="sign" parameterType="com.waibao.dao.waibao.dataobject.WaibaoSignDO" >
    insert into waibao_sign 
    (
        project_id, user_id ,is_choose,gmt_created,gmt_modified
    )
    values 
    (
    	#{projectId,jdbcType=BIGINT}, 
    	#{userId,jdbcType=BIGINT}, 
    	0,
    	NOW(),
		NOW()
	)
  </insert>
  <update id="appointment" parameterType="com.waibao.dao.waibao.dataobject.AppointmentDO" >
    update waibao_sign
    set is_choose = 1,
		gmt_modified = NOW()
    where project_id = #{projectId,jdbcType=BIGINT}
    AND user_id = #{userId,jdbcType=BIGINT}
  </update>
</mapper>